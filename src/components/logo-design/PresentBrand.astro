---
const { projects = [] } = Astro.props;
import Image from "astro/components/Image.astro";
import Logo1 from "../../assets/home/portfolio/logos/1.png";
import Logo2 from "../../assets/home/portfolio/logos/2.png";
import Logo3 from "../../assets/home/portfolio/logos/3.png";
import Logo4 from "../../assets/home/portfolio/logos/4.png";

const logos = [Logo1, Logo2, Logo3, Logo4, Logo1, Logo2, Logo3, Logo4, Logo4];
const filters = ["Logo Design", "Website", "Mobile App", "Video Animation"];

import Website1 from "../../assets/home/portfolio/websites/1.webp";

const websites = [Website1, Website1, Website1, Website1, Website1];
import CommonButton from "../common/CommonButton.astro";
---

<section class="internal-padding py-20">
  <header class="relative mb-12">
    <div class="mb-6 flex items-center justify-between">
      <h2 class="mb-3 text-4xl font-semibold text-[#000047] md:text-[54px]">
        Let Us Present Your Brand
      </h2>
      <CommonButton>
        Letâ€™s get started <svg
          width="16"
          height="16"
          viewBox="0 0 16 16"
          fill="currentColor"
          xmlns="http://www.w3.org/2000/svg"
          class="text ml-2 transition-transform duration-300 ease-in-out group-hover:translate-x-1 group-hover:text-[#9D7EFF]"
        >
          <path
            d="M0.321289 8.9375L12.2213 8.9375L6.73379 14.425L8.07129 15.75L15.8213 8L8.07129 0.25L6.73379 1.575L12.2213 7.0625L0.321289 7.0625L0.321289 8.9375Z"
            fill="currentColor"></path>
        </svg>
      </CommonButton>
    </div>
    <p class="text-base leading-6 text-[#2B2B2B]">
      We design narratives that evoke powerful emotions in your audience and
      truly connect with them. Beyond words, a consistent visual identity across
      all touchpoints that emphasizes your company's essential values is
      guaranteed by our design expertise. Your message is amplified and your
      target audience is engaged with carefully crafted, strategically placed
      content on each channel.
    </p>
  </header>

  <div class="mx-auto">
    <div
      id="portfolio-grid"
      class="grid grid-cols-2 gap-6 md:grid-cols-3 lg:grid-cols-3"
    >
      {
        // Default: show logos (Logo Design)
        logos.map((logo, index) => (
          <Image
            src={logo}
            alt={`Project Logo ${index + 1}`}
            class="portfolio-item w-full max-w-[220px] md:max-w-[480px] aspect-square rounded-lg"
            data-category="Logo Design"
          />
        ))
      }
    </div>
  </div>
</section>

<script>
  import { gsap } from "../../utils/gsapUtils.js";

  document.addEventListener("DOMContentLoaded", () => {
    // Animate filter buttons on scroll in

    // Animate portfolio items on scroll in
    gsap.from(".portfolio-item", {
      opacity: 0,
      scale: 0.92,
      y: 40,
      stagger: 0.08,
      duration: 0.7,
      ease: "power3.out",
      scrollTrigger: {
        trigger: "#portfolio-grid",
        start: "top 85%",
      },
    });

    // Animate items on filter change
    const nav = document.getElementById("portfolio-filters");
    const grid = document.getElementById("portfolio-grid");
    if (!nav || !grid) return;

    nav.addEventListener("click", (e) => {
      const btn = e.target.closest(".portfolio-filter-btn");
      if (!btn) return;
      nav
        .querySelectorAll(".portfolio-filter-btn")
        .forEach((b) => b.classList.remove("selected"));
      btn.classList.add("selected");

      const filter = btn.dataset.filter;
      const items = Array.from(grid.querySelectorAll(".portfolio-item"));
      const toHide = items.filter(
        (item) =>
          item.style.display !== "none" && item.dataset.category !== filter,
      );
      const toShow = items.filter((item) => item.dataset.category === filter);

      // Animate out current items
      gsap.to(toHide, {
        opacity: 0,
        scale: 0.92,
        y: 40,
        stagger: 0.05,
        duration: 0.3,
        ease: "power2.in",
        onComplete: () => {
          toHide.forEach((item) => (item.style.display = "none"));
          // Animate in new items
          toShow.forEach((item) => {
            item.style.display = "";
            item.style.opacity = 0;
            item.style.transform = "scale(0.92) translateY(40px)";
          });
          gsap.to(toShow, {
            opacity: 1,
            scale: 1,
            y: 0,
            stagger: 0.07,
            duration: 0.5,
            ease: "power3.out",
          });
        },
      });
    });

    // Show only logos by default (with animation)
    const allItems = Array.from(grid.querySelectorAll(".portfolio-item"));
    const toShow = allItems.filter(
      (item) => item.dataset.category === "Logo Design",
    );
    const toHide = allItems.filter(
      (item) => item.dataset.category !== "Logo Design",
    );
    toHide.forEach((item) => (item.style.display = "none"));
    toShow.forEach((item) => {
      item.style.display = "";
      item.style.opacity = 0;
      item.style.transform = "scale(0.92) translateY(40px)";
    });
    gsap.to(toShow, {
      opacity: 1,
      scale: 1,
      y: 0,
      stagger: 0.07,
      duration: 0.5,
      ease: "power3.out",
    });
  });
</script>

<!-- <style>
  :root {
    --gradient-start: #9d7eff;
    --gradient-end: #8067ce;
    --btn-inactive-bg: #ece6ff;
    --btn-inactive-text: #8067ce;
  }

  .portfolio-filter-btn {
    cursor: pointer;
    border: none;
    outline: none;
    padding: 0.625rem 1.5rem;
    font-size: 1.125rem;
    font-weight: 600;
    background: var(--btn-inactive-bg);
    color: var(--btn-inactive-text);
    transition:
      background 0.28s cubic-bezier(0.22, 1, 0.36, 1),
      color 0.28s cubic-bezier(0.22, 1, 0.36, 1),
      box-shadow 0.28s cubic-bezier(0.22, 1, 0.36, 1),
      transform 0.28s cubic-bezier(0.22, 1, 0.36, 1);
    box-shadow: 0 2px 0 rgba(0, 0, 0, 0.02);
    position: relative;
    z-index: 1;
  }

  .portfolio-filter-btn.selected {
    background: linear-gradient(
      90deg,
      var(--gradient-start),
      var(--gradient-end)
    );
    color: #fff;
    box-shadow: 0 8px 30px rgba(157, 126, 255, 0.12);
    transform: translateY(-2px) scale(1.03);
    border-radius: 1.5rem;
  }

  .portfolio-filter-btn:not(.selected):hover {
    background: #e0d6fa;
    color: var(--gradient-end);
    transform: translateY(-2px) scale(1.01);
  }

  .website-scroll-container {
    position: relative;
    overflow: hidden;
    height: 410px;
    width: 100%;
    max-width: 480px;
    border-radius: 0.75rem;
    background: #fff;
  }

  .website-scroll-img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    /* Make sure the image is tall enough to scroll */
    min-height: 100%;
    transition: transform 4s linear;
    will-change: transform;
  }

  /* On hover, scroll the image up to reveal the bottom */
  .website-scroll-container:hover .website-scroll-img {
    transform: translateY(calc(-100% + 410px));
  }

  .portfolio-bg-title {
    opacity: 0;
    filter: blur(12px);
    transform: translateY(40px) scale(1.08);
    transition:
      opacity 0.8s cubic-bezier(0.22, 1, 0.36, 1),
      filter 0.8s cubic-bezier(0.22, 1, 0.36, 1),
      transform 0.8s cubic-bezier(0.22, 1, 0.36, 1);
    pointer-events: none;
    user-select: none;
    z-index: 0; /* Lower than header content */
    opacity: 0.13; /* Subtle! */
  }

  .portfolio-bg-title.visible {
    opacity: 0.13; /* Keep it subtle when visible */
    filter: blur(0);
    transform: translateY(0) scale(1);
  }
</style> -->
