---
import CommonButton from "../common/CommonButton.astro";
import Image from "astro/components/Image.astro";
import OurMissionImage from "../../assets/about/our-mission.png";
---

<section id="our-mission" class="left-padding flex flex-col lg:flex-row items-center justify-between gap-24">
  <div>
    <h2
      class="mb-8 text-[40px] leading-[50px] font-medium text-[#000047] xl:text-[50px]"
    >
      Our Mission
    </h2>
    <p
      class="mb-14 text-base text-[#2A2111] lg:text-lg xl:text-xl 2xl:text-2xl"
    >
      At NixxonTec, our mission is to revolutionize the digital landscape. It is
      our objective to turn possibilities into realities besides providing
      services. To prosper in the digital era, we facilitate startups, small
      businesses, and large corporations. Our aim is to stimulate expansion, be
      it via custom website development services, data interpretation, or
      cloud-based solutions. Creating flawless user experiences is what drives
      us crazy. Technology should be easy to use, enjoyable, and intuitive for
      use.
    </p>
    <CommonButton typography="text-sm 2xl:text-base">
      Have a Plan? Let's Get Started
    </CommonButton>
  </div>
  <Image
    src={OurMissionImage}
    alt="Our Mission"
    class="mission-image h-[300px] w-[300px] md:h-[400px] md:w-[400px] lg:h-[500px] lg:w-[500px] xl:h-[600px] xl:w-[600px] 2xl:h-[700px] 2xl:w-[700px]"
  />
</section>

<script>
  import { gsap, ScrollTrigger } from "../../utils/gsapUtils";

  gsap.registerPlugin(ScrollTrigger);

  // subtle reveal for heading, paragraph and button
  gsap.from("#our-mission h2", {
    y: 20,
    opacity: 0,
    duration: 0.8,
    ease: "power2.out",
    scrollTrigger: {
      trigger: "#our-mission h2",
      start: "top 90%",
    },
  });

  gsap.from("#our-mission p", {
    y: 20,
    opacity: 0,
    duration: 0.9,
    delay: 0.1,
    ease: "power2.out",
    scrollTrigger: {
      trigger: "#our-mission p",
      start: "top 90%",
    },
  });

  gsap.from("#our-mission button", {
    y: 8,
    opacity: 0,
    duration: 0.7,
    delay: 0.22,
    ease: "power2.out",
    scrollTrigger: {
      trigger: "#our-mission button",
      start: "top 92%",
    },
  });

  // image reveal with slight rotation and parallax on scroll
  const img = document.querySelector("#our-mission .mission-image");
  if (img) {
    gsap.fromTo(
      img,
      { y: 30, opacity: 0, rotate: -2, scale: 0.98 },
      {
        y: 0,
        opacity: 1,
        rotate: 0,
        scale: 1,
        duration: 1,
        ease: "power3.out",
        scrollTrigger: {
          trigger: img,
          start: "top 85%",
        },
      }
    );

    // gentle parallax as the section scrolls
    gsap.to(img, {
      y: -18,
      ease: "none",
      scrollTrigger: {
        trigger: "#our-mission",
        start: "top bottom",
        end: "bottom top",
        scrub: 0.6,
      },
    });

    // micro-interaction: follow cursor slightly on hover for a tactile feel
    img.style.willChange = "transform";
    img.addEventListener("mousemove", (e) => {
      const rect = img.getBoundingClientRect();
      const relX = (e.clientX - rect.left) / rect.width - 0.5;
      const relY = (e.clientY - rect.top) / rect.height - 0.5;
      gsap.to(img, {
        x: relX * 10,
        y: relY * 8,
        rotation: relX * 2,
        duration: 0.35,
        ease: "power1.out",
      });
    });
    img.addEventListener("mouseleave", () => {
      gsap.to(img, { x: 0, y: 0, rotation: 0, duration: 0.45, ease: "power2.out" });
    });
  }
</script>
